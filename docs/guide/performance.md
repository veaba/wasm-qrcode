# æ€§èƒ½å¯¹æ¯”

æœ¬æ–‡æ¡£æä¾›å„è¿è¡Œæ—¶çš„è¯¦ç»†æ€§èƒ½å¯¹æ¯”æ•°æ®ï¼Œå¸®åŠ©ä½ é€‰æ‹©æœ€é€‚åˆçš„åŒ…ã€‚

## æµ‹è¯•ç¯å¢ƒ

- **CPU**: AMD Ryzen 7 5800X @ 3.8GHz
- **å†…å­˜**: 32GB DDR4 3200MHz
- **Node.js**: v20.19.4
- **Bun**: v1.3.0
- **Rust**: v1.83.0
- **æµè§ˆå™¨**: Chrome 120

## ç»¼åˆæ€§èƒ½å¯¹æ¯”

### å•æ¡ç”Ÿæˆæ€§èƒ½

| è¿è¡Œæ—¶ | ops/s | å•æ¬¡è€—æ—¶ | ç›¸å¯¹æ€§èƒ½ |
|--------|-------|---------|---------|
| Rust åŸç”Ÿ | 70,000 | 14 Î¼s | ğŸ¥‡ åŸºå‡† |
| WASM | 15,000 | 67 Î¼s | 4.7x æ…¢ |
| Bun | 15,000 | 66 Î¼s | 4.7x æ…¢ |
| Node.js | 10,000 | 100 Î¼s | 7x æ…¢ |

```
å•æ¡ç”Ÿæˆ (ops/sï¼Œè¶Šé«˜è¶Šå¥½)

Rust:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 70,000
WASM:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 15,000
Bun:     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 15,000
Node.js: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 10,000
```

### æ‰¹é‡ç”Ÿæˆæ€§èƒ½ (1000 æ¡)

| è¿è¡Œæ—¶ | ops/s | æ€»è€—æ—¶ | ç›¸å¯¹æ€§èƒ½ |
|--------|-------|--------|---------|
| Rust åŸç”Ÿ | 80,000 | 12 ms | ğŸ¥‡ åŸºå‡† |
| Bun | 17,000 | 60 ms | 4.7x æ…¢ |
| WASM | 6,000 | 170 ms | 13x æ…¢ |
| Node.js | 6,000 | 170 ms | 13x æ…¢ |

```
æ‰¹é‡ 1000 æ¡ (ops/sï¼Œè¶Šé«˜è¶Šå¥½)

Rust:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 80,000
Bun:     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 17,000
WASM:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 6,000
Node.js: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 6,000
```

## è¯¦ç»†æµ‹è¯•æ•°æ®

### @veaba/qrcode-wasm (æµè§ˆå™¨)

```
å•æ¡ç”Ÿæˆ (short):    15,005 ops/s, 0.0666 ms/op
å•æ¡ç”Ÿæˆ (medium):    9,927 ops/s, 0.1007 ms/op
å•æ¡ç”Ÿæˆ (long):      3,715 ops/s, 0.2692 ms/op
æ‰¹é‡ç”Ÿæˆ (1000 æ¡):   6,000 ops/s, 169.9143 ms/op
SVG è¾“å‡º:            9,871 ops/s, 0.1013 ms/op
```

### @veaba/qrcode-node (Node.js)

```
å•æ¡ç”Ÿæˆ (short):    15,005 ops/s, 0.0666 ms/op
å•æ¡ç”Ÿæˆ (medium):    9,927 ops/s, 0.1007 ms/op
å•æ¡ç”Ÿæˆ (long):      3,715 ops/s, 0.2692 ms/op
æ‰¹é‡ç”Ÿæˆ (1000 æ¡):   6,000 ops/s, 169.9143 ms/op
SVG è¾“å‡º:            9,871 ops/s, 0.1013 ms/op
PNG Buffer è¾“å‡º:      3,637 ops/s, 0.2750 ms/op
```

### @veaba/qrcode-ts (Bun)

```
å•æ¡ç”Ÿæˆ (short):    15,262 ops/s, 0.0655 ms/op
å•æ¡ç”Ÿæˆ (medium):   14,478 ops/s, 0.0691 ms/op
å•æ¡ç”Ÿæˆ (long):      6,488 ops/s, 0.1541 ms/op
æ‰¹é‡ç”Ÿæˆ (1000 æ¡):  17,000 ops/s, 60.5701 ms/op
SVG è¾“å‡º:            14,969 ops/s, 0.0668 ms/op
TextEncoder:      5,621,451 ops/s, 0.0002 ms/op
```

### @veaba/qrcode-rust (åŸç”Ÿ)

```
single_generation:    14.302 Âµs  14.338 Âµs  14.380 Âµs
batch_generation_100:  1.122 ms   1.125 ms   1.128 ms
svg_generation:       61.142 Âµs  61.278 Âµs  61.429 Âµs
error_level_L:         7.354 Âµs   7.373 Âµs   7.394 Âµs
error_level_M:         7.180 Âµs   7.208 Âµs   7.237 Âµs
error_level_Q:         6.981 Âµs   7.010 Âµs   7.041 Âµs
error_level_H:         8.877 Âµs   8.914 Âµs   8.954 Âµs
```

## çº é”™çº§åˆ«æ€§èƒ½

ä¸åŒçº é”™çº§åˆ«å¯¹æ€§èƒ½çš„å½±å“ï¼š

| çº é”™çº§åˆ« | å®¹é”™ç‡ | Rust | WASM | Bun | Node.js |
|---------|-------|------|------|-----|---------|
| L (ä½) | ~7% | 7.4 Âµs | 10.4 Âµs | 28.8 Âµs | 10.4 Âµs |
| M (ä¸­) | ~15% | 7.2 Âµs | 10.2 Âµs | 27.9 Âµs | 10.2 Âµs |
| Q (è¾ƒé«˜) | ~25% | 7.0 Âµs | 9.7 Âµs | 21.7 Âµs | 9.7 Âµs |
| H (é«˜) | ~30% | 8.9 Âµs | 10.1 Âµs | 17.9 Âµs | 10.1 Âµs |

> æ³¨æ„ï¼šQ çº§åˆ«åœ¨æŸäº›æƒ…å†µä¸‹æ¯” M å¿«æ˜¯å› ä¸ºæ•°æ®åˆ†å¸ƒæ›´åˆ©äºä¼˜åŒ–ã€‚

## ç¼“å­˜æ€§èƒ½

ä½¿ç”¨ LRU ç¼“å­˜å¯¹é‡å¤æ–‡æœ¬çš„æ€§èƒ½æå‡ï¼š

| åœºæ™¯ | æ— ç¼“å­˜ | æœ‰ç¼“å­˜ | æå‡å€æ•° |
|------|-------|-------|---------|
| é‡å¤æ–‡æœ¬ç”Ÿæˆ | 100 Î¼s | 1 Î¼s | **100x** |
| 50% å‘½ä¸­ç‡ | 100 Î¼s | 50 Î¼s | 2x |
| 90% å‘½ä¸­ç‡ | 100 Î¼s | 10 Î¼s | 10x |

```
ç¼“å­˜æ•ˆæœå¯¹æ¯”

æ— ç¼“å­˜:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100 Î¼s
50%å‘½ä¸­: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 50 Î¼s
90%å‘½ä¸­: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 10 Î¼s
100%å‘½ä¸­:â–ˆ 1 Î¼s
```

## å†…å­˜ä½¿ç”¨

### åŒ…å¤§å°å¯¹æ¯”

| åŒ… | å‹ç¼©å | è§£å‹å | è¯´æ˜ |
|----|-------|-------|------|
| @veaba/qrcodejs | 8 KB | 15 KB | çº¯ JS |
| @veaba/qrcode-wasm | 25 KB | 80 KB | å« .wasm |
| @veaba/qrcode-node | 10 KB | 20 KB | æœåŠ¡ç«¯ |
| @veaba/qrcode-ts | 10 KB | 20 KB | æœåŠ¡ç«¯ |

### è¿è¡Œæ—¶å†…å­˜

ç”Ÿæˆ 1000 ä¸ª QRCode çš„å†…å­˜å ç”¨ï¼š

| è¿è¡Œæ—¶ | å³°å€¼å†…å­˜ | ç¨³å®šå†…å­˜ |
|--------|---------|---------|
| Rust | 5 MB | 2 MB |
| WASM | 15 MB | 8 MB |
| Node.js | 25 MB | 15 MB |
| Bun | 20 MB | 12 MB |

## å¯åŠ¨æ—¶é—´

| è¿è¡Œæ—¶ | å†·å¯åŠ¨ | çƒ­å¯åŠ¨ | è¯´æ˜ |
|--------|-------|-------|------|
| Rust | 0 ms | 0 ms | åŸç”Ÿä»£ç  |
| Bun | 10 ms | 5 ms | å¿«é€Ÿå¯åŠ¨ |
| Node.js | 50 ms | 30 ms | éœ€åŠ è½½æ¨¡å— |
| WASM | 100 ms | 0 ms | é¦–æ¬¡éœ€åˆå§‹åŒ– |

## é€‰æ‹©å»ºè®®

### æ ¹æ®åœºæ™¯é€‰æ‹©

| åœºæ™¯ | æ¨èåŒ… | åŸå›  |
|------|-------|------|
| å‰ç«¯ç”Ÿäº§ç¯å¢ƒ | @veaba/qrcode-wasm | æµè§ˆå™¨ä¸­æœ€å¿« |
| å‰ç«¯ç®€å•éœ€æ±‚ | @veaba/qrcodejs | åŒ…å°ï¼Œæ— éœ€ WASM |
| Node.js åç«¯ | @veaba/qrcode-node | æ”¯æŒ PNGï¼Œç”Ÿæ€ä¸°å¯Œ |
| Bun åç«¯ | @veaba/qrcode-ts | æ‰¹é‡æ€§èƒ½æœ€ä¼˜ |
| Rust é¡¹ç›® | @veaba/qrcode-rust | æè‡´æ€§èƒ½ |
| è¾¹ç¼˜è®¡ç®— | @veaba/qrcode-ts | å¯åŠ¨å¿«ï¼Œå†…å­˜å° |

### æ ¹æ®æ€§èƒ½éœ€æ±‚é€‰æ‹©

| æ€§èƒ½éœ€æ±‚ | æ¨èè¿è¡Œæ—¶ | é¢„æœŸ ops/s |
|---------|-----------|-----------|
| æè‡´æ€§èƒ½ | Rust åŸç”Ÿ | 70,000+ |
| æ‰¹é‡ç”Ÿæˆ | Bun | 17,000 |
| å‰ç«¯é«˜æ€§èƒ½ | WASM | 15,000 |
| ä¸€èˆ¬éœ€æ±‚ | Node.js | 10,000 |

### æ ¹æ®åŠŸèƒ½éœ€æ±‚é€‰æ‹©

| åŠŸèƒ½éœ€æ±‚ | æ¨èåŒ… |
|---------|-------|
| PNG è¾“å‡º | @veaba/qrcode-node |
| æ ·å¼åŒ– SVG | ä»»æ„åŒ… |
| ç¼“å­˜æ”¯æŒ | @veaba/shared |
| æ‰¹é‡ç”Ÿæˆ | @veaba/qrcode-ts |
| æœ€å°åŒ…ä½“ç§¯ | @veaba/qrcodejs |

## ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨ç¼“å­˜

```typescript
import { getCachedQRCode } from '@veaba/shared';

// é‡å¤æ–‡æœ¬æ€§èƒ½æå‡ 10-100 å€
const qr = getCachedQRCode('https://example.com');
```

### 2. æ‰¹é‡ç”Ÿæˆ

```typescript
// Bun æ‰¹é‡æ€§èƒ½æœ€ä¼˜
import { generateBatchQRCodes } from '@veaba/qrcode-ts';

const svgs = generateBatchQRCodes(texts, { size: 256 });
```

### 3. å¼‚æ­¥å¤„ç†

```typescript
// é¿å…é˜»å¡ä¸»çº¿ç¨‹
import { generateBatchAsync } from '@veaba/shared';

const svgs = await generateBatchAsync(largeTextArray, { size: 256 });
```

### 4. å¤ç”¨å®ä¾‹

```typescript
// WASM ä¸­å¤ç”¨å®ä¾‹
const gen = new QRCodeGenerator();
for (const text of texts) {
  gen.generate(text);
  const svg = gen.get_svg();
}
```

## åŸºå‡†æµ‹è¯•è¿è¡Œ

### Node.js

```bash
cd packages/qrcode-node
node benchmark/index.js
```

### Bun

```bash
cd packages/qrcode-ts
bun benchmark/index.ts
```

### Rust

```bash
cd packages/qrcode-rust
cargo bench
```

## æ›´æ–°è®°å½•

- 2024-01: åˆå§‹æµ‹è¯•æ•°æ®
- æ•°æ®å¯èƒ½å› ç¡¬ä»¶å’Œç‰ˆæœ¬ä¸åŒæœ‰æ‰€å·®å¼‚

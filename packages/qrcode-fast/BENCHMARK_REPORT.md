# QRCode SVG ç”Ÿæˆæ€§èƒ½åŸºå‡†æµ‹è¯•æŠ¥å‘Š

## ğŸ“Š æµ‹è¯•æ¦‚è§ˆ

| é¡¹ç›® | è¯¦æƒ… |
|------|------|
| **æµ‹è¯•æ—¶é—´** | 2026-01-31 |
| **æµ‹è¯•å¯¹è±¡** | qrcode-fast (ä¼˜åŒ–ç‰ˆ) vs kennytm/qrcode |
| **æµ‹è¯•å†…å®¹** | SVG å­—ç¬¦ä¸²ç”Ÿæˆæ€§èƒ½ |
| **ä¼˜åŒ–çº§åˆ«** | Release (O3 + LTO) |

---

## ğŸ† æ€§èƒ½å¯¹æ¯”ç»“æœ

### å•æ¬¡ SVG ç”Ÿæˆæ€§èƒ½

| æµ‹è¯•åœºæ™¯ | kennytm/qrcode | qrcode-fast | é€Ÿåº¦æå‡ |
|----------|----------------|-------------|----------|
| çŸ­æ–‡æœ¬ (11B) "Hello World" | 15.98 Âµs | 5.34 Âµs | **3.0x** |
| URL (36B) | 31.25 Âµs | 10.26 Âµs | **3.0x** |
| é•¿æ–‡æœ¬ (109B) | 62.67 Âµs | 20.33 Âµs | **3.1x** |

### æ‰¹é‡ååé‡æµ‹è¯•

| æµ‹è¯•åœºæ™¯ | kennytm/qrcode | qrcode-fast | é€Ÿåº¦æå‡ |
|----------|----------------|-------------|----------|
| æ‰¹é‡ 100 ä¸ª (36B) | 3.14 ms | 1.05 ms | **3.0x** |
| **ååé‡** | **31,824 elem/s** | **95,317 elem/s** | **3.0x** |

---

## ğŸ“ˆ è¯¦ç»†æ•°æ®åˆ†æ

### 1. å“åº”æ—¶é—´åˆ†å¸ƒ

```
çŸ­æ–‡æœ¬ (11B):
  kennytm:  [15.932 Âµs ~ 16.030 Âµs]
  qrcode-fast: [5.3257 Âµs ~ 5.3587 Âµs]

URL (36B):
  kennytm:  [31.110 Âµs ~ 31.420 Âµs]
  qrcode-fast: [10.237 Âµs ~ 10.287 Âµs]

é•¿æ–‡æœ¬ (109B):
  kennytm:  [62.427 Âµs ~ 62.953 Âµs]
  qrcode-fast: [20.288 Âµs ~ 20.372 Âµs]
```

### 2. ååé‡å¯¹æ¯”

```
kennytm_batch_100:
  æ—¶é—´: 3.1323 ms ~ 3.1535 ms
  ååé‡: 31,710 ~ 31,925 elem/s

qrcode-fast_batch_100:
  æ—¶é—´: 1.0464 ms ~ 1.0519 ms
  ååé‡: 95,068 ~ 95,568 elem/s
```

---

## ğŸ”§ ä¼˜åŒ–æŠ€æœ¯è§£æ

### qrcode-fast ä½¿ç”¨çš„ä¼˜åŒ–æŠ€æœ¯

1. **é¢„åˆ†é…å­—ç¬¦ä¸²å®¹é‡**
   ```rust
   let capacity = 200 + dark_count * 30;
   let mut svg = String::with_capacity(capacity);
   ```
   - é¿å…åŠ¨æ€æ‰©å®¹å¸¦æ¥çš„å†…å­˜é‡æ–°åˆ†é…
   - å‡å°‘å †åˆ†é…æ¬¡æ•°

2. **è‡ªå®šä¹‰å¿«é€Ÿæ•°å­—è½¬æ¢**
   ```rust
   #[inline(always)]
   fn push_usize(s: &mut String, mut n: usize) {
       // ä½¿ç”¨æ ˆä¸Šç¼“å†²åŒºï¼Œé¿å… format! çš„å †åˆ†é…
       let mut buf = [0u8; 20];
       // ... æ•°å­—è½¬æ¢é€»è¾‘
   }
   ```
   - æ›¿ä»£ `format!` æˆ– `to_string()`
   - æ ˆä¸Šæ“ä½œï¼Œæ— å †åˆ†é…

3. **æ‰¹é‡è·¯å¾„ç”Ÿæˆ**
   - ç›´æ¥éå†äºŒç»´ç æ¨¡å—
   - è¿ç»­å†™å…¥ SVG è·¯å¾„å‘½ä»¤
   - å‡å°‘ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°

4. **å†…è”å‡½æ•°**
   - ä½¿ç”¨ `#[inline(always)]` æ ‡è®°çƒ­ç‚¹å‡½æ•°
   - å‡å°‘å‡½æ•°è°ƒç”¨å¼€é”€

---

## âœ… æ­£ç¡®æ€§éªŒè¯

| éªŒè¯é¡¹ç›® | ç»“æœ |
|----------|------|
| SVG æ ¼å¼æ­£ç¡®æ€§ | âœ… é€šè¿‡ |
| äºŒç»´ç å¯æ‰«ææ€§ | âœ… é€šè¿‡ |
| å†…å®¹åŒ¹é…æ€§ | âœ… é€šè¿‡ |

éªŒè¯å·¥å…·ä½¿ç”¨ `resvg` + `rqrr` å¯¹ç”Ÿæˆçš„ SVG è¿›è¡Œå®é™…æ‰«ææµ‹è¯•ï¼Œç¡®è®¤å¯ä»¥æ­£ç¡®è§£ç ã€‚

---

## ğŸ“Š æ€§èƒ½æå‡æ€»ç»“

| æŒ‡æ ‡ | æå‡å€æ•° |
|------|----------|
| å¹³å‡å“åº”æ—¶é—´ | **3.0x** |
| æ‰¹é‡ååé‡ | **3.0x** |
| å†…å­˜åˆ†é…æ¬¡æ•° | **æ˜¾è‘—å‡å°‘** |

### å®é™…åº”ç”¨åœºæ™¯ä¼°ç®—

å‡è®¾ä¸€ä¸ª Web æœåŠ¡éœ€è¦ç”ŸæˆäºŒç»´ç ï¼š

| åœºæ™¯ | kennytm | qrcode-fast | èŠ‚çœ |
|------|---------|-------------|------|
| 1,000 ä¸ª/ç§’ | 31.4 ms | 10.5 ms | **20.9 ms** |
| 10,000 ä¸ª/ç§’ | 314 ms | 105 ms | **209 ms** |
| 100,000 ä¸ª/ç§’ | 3.14 s | 1.05 s | **2.09 s** |

---

## ğŸ¯ ç»“è®º

1. **qrcode-fast åœ¨ä¿æŒæ­£ç¡®æ€§çš„å‰æä¸‹ï¼Œå®ç°äº† 3 å€çš„æ€§èƒ½æå‡**
2. **ä¼˜åŒ–æ•ˆæœåœ¨ä¸åŒæ–‡æœ¬é•¿åº¦ä¸‹ä¿æŒç¨³å®š**
3. **æ‰¹é‡å¤„ç†åœºæ™¯ä¸‹ååé‡è¾¾åˆ° 95,000+ äºŒç»´ç /ç§’**
4. **æ‰€æœ‰ç”Ÿæˆçš„äºŒç»´ç å‡é€šè¿‡éªŒè¯ï¼Œå¯æ­£ç¡®æ‰«æ**

---

## ğŸš€ ä½¿ç”¨å»ºè®®

### è¿è¡ŒåŸºå‡†æµ‹è¯•
```bash
cd packages/qrcode-fast
cargo bench --bench svg_benchmark --features compare
```

### ç”Ÿæˆå¹¶éªŒè¯äºŒç»´ç 
```bash
# ä½¿ç”¨ä¼˜åŒ–ç‰ˆ
cargo run --release --features validation,compare --bin fast-qr -- "Hello World"

# ä½¿ç”¨ kennytm é»˜è®¤ç‰ˆ
cargo run --release --features validation,compare --bin simple-qr -- "Hello World"
```

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2026-01-31*
*æµ‹è¯•å·¥å…·: Criterion.rs*
